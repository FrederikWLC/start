{% extends "base.html" %}
{% block body %}

      <div class="container has-text-centered">
        <p class="title">Messages: <b>{{profile.name}}</b></p>
        <br>
            {% if messages %}
            {% for message in messages %}
              <div class="message-container" {% if message.sender == current_user %} id="sender_is_current_user" {% else %} id="sender_is_profile" {% endif %}>
                <div id="profile_pic"><img src="{{ message.sender.profile_pic(50) }}"></div>
                <div class="message">
                <textarea class="textarea has-fixed-size" placeholder="Type a message..."  id="text" readonly>{{message.content}}</textarea>
              </div>
              </div>
        {% endfor %}
        {% endif %}
        <div class="control" id="message-field">
        <div id="field">
  <textarea class="textarea has-fixed-size" placeholder="Type a message..." id="text-field" rows="1"></textarea> 
</div>
<div id="send">
  <button class="button is-link is-medium is-inverted" id="send-button">
    <span class="icon is-medium">
      <span class="fa-2x">
      <i class="fa fa-long-arrow-right"></i>
    </span>
    </span>
  </button>
</div>
</div>
</div>

{% include "footer.html" %}
{% endblock %}
{% block scripts %}
<style>

.message-container {
  margin: auto;
  margin-bottom: 10px;
  width: 45%;
  display:flex;
  padding: 0px;
  clear: both;
}

.message {
  float:right;
  flex-grow: 1;
  width: 90%;
}

#profile_pic {
  height:50px;
  width: 50px;
  padding: 0px;
  flex-grow: 1;
  margin-right: 5px;
}

#message-field {
  width: 100%;
  height: 46px;
  margin: auto;
  float:right;
  display:flex;
}

#field {
  float:left;
  height:46px;
  width: 83%;
  padding: 0px;
  flex-grow: 1;
}

#send {
  float:right;
  height:46px;
  width: 70px;
  padding: 0px;
  flex-grow: 0;
}

#send-button {
  width: 70px;
  height: 46px;
}

#text-field {
  height:46px;
  width: 100%;
}

#sender_is_current_user {
  float:left;
}

#sender_is_profile {
  float:right;
}


</style>
<script>

 $(document).on("click", "#send-button", function() {
   console.log("Send");
    $.post({
      type: "POST",
      url: "/messages/{{profile.username}}/",
      data: {"content": $("#text-field").val()},
      success(response) {
        var status = JSON.parse(response)["status"];
        if (status === "Successfully sent") {location.reload();} 
      }});
  });
</script>
<script src="/static/js/navbar.js"></script>>
{% endblock %}