{% extends "base.html" %}
{% block body %}
  
          
<div class="container has-text-centered" id="container">
  
  <div valign="top" id="bigBox" class="row">
  
    <div id="leftBox" class="column">
      <a href="javascript:location.replace('/profile/')" class="button is-primary is-normal is-rounded is-inverted" id="cancel-button">
      <span class="icon is-normal is-danger">
      <i class="fa fa-times fa-2x"></i>
      </span>
      </a>
    </div>

    <div id="middleBox" class="column">
      <h1 class="title" id="header">Edit Profile</h1>
    </div>
    
    <div id="rightBox" class="column">
      <button class="button is-primary is-normal is-rounded" id="save-button">
      <span>Save</span>
      </button>
    </div>

  </div>

  <hr>

  <div  width="256px">
      <img src="{{ current_user.profile_pic(256) }}">
  </div>
  
  <div>
      <h1><b>Name</b></h1>
      <textarea class="textarea has-fixed-size" placeholder="Add your name" id="name-field" rows="1">{{current_user.name}}</textarea> 
      <br>
      <h1><b>Bio</b></h1>
      <textarea class="textarea has-fixed-size" placeholder="Add your bio" id="bio-field" rows="3">{% if current_user.bio %}{{ current_user.bio }}{% endif %}</textarea>
      <br>
      <h1><b>Location</b></h1>
      <textarea class="textarea has-fixed-size" placeholder="Add your location" id="location-field" rows="1">{{ current_user.location }}</textarea>

  </div>

  <br>

  <div id="feedback">
  </div>

</div>
{% endblock %}
{% block scripts %}
<style>

#container {
  width: 500px;
  height: 0px;
  margin-bottom: 0;
}

#datop:after {
  display: table;
  clear: both;
  width:100%;
}

#cancel-button {
  margin: 10px;
  border-radius: 0px;
}


#header {
  margin: 5px;
  float: middle;
 font-size: 24px;
}


#save-button {
  float: right;
}

#profile_pic {
  position:absolute;
}

.column {
  margin-top: 10px;
  margin-bottom: 10px;
  vertical-align: middle;
  float: left;
  padding: 10px;
}

/* Clear floats after the columns */
.row:after {
  content: "";
  display: table;
  clear: both;
}

#bigBox {
  width:100%;
  height: 50px;
}

#leftBox {
  height: 100%;
  float:left;
  width: 20%;
  padding: 0px;
  padding-right: 10px;
}
#middleBox {
  height: 100%;
  float:middle;
  width: 30%;
}

#rightBox {
  height: 100%;
  float:right;
  width: 50%;
}

</style>
<script src="/static/js/navbar.js"></script>
<script>
  function message(status, shake=false, id="") {
  if (shake) {
    $("#"+id).effect("shake", {direction: "right", times: 2, distance: 8}, 250);
  } 
  document.getElementById("feedback").innerHTML = status;
  $("#feedback").show().delay(2000).fadeOut();
}
 $(document).on("click", "#save-button", function() {
   console.log("Applying edit");
    $.post({
      type: "POST",
      url: "/settings/profile/",
      data: {"name": $("#name-field").val(),
             "bio": $("#bio-field").val(),
             "location": $("#location-field").val()},
      success(response) {
        var status = JSON.parse(response)["status"];
        if (status === "Successfully saved") { location.replace("/profile/"); }
        else{message(status, true, "feedback");}
        
      }});
  });
</script>
{% endblock %}